const e=".",n="null",t="\\",i='"',r=",";function l(e){return e.replace(/\\/g,`${t}${t}`).replace(/"/g,`${t}${i}`).replace(/\n/g,`${t}n`).replace(/\r/g,`${t}r`).replace(/\t/g,`${t}t`)}function o(e){if(null===e)return null;if("string"==typeof e||"boolean"==typeof e)return e;if("number"==typeof e)return Object.is(e,-0)?0:Number.isFinite(e)?e:null;if("bigint"==typeof e)return e>=Number.MIN_SAFE_INTEGER&&e<=Number.MAX_SAFE_INTEGER?Number(e):e.toString();if(e instanceof Date)return e.toISOString();if(Array.isArray(e))return e.map(o);if(e instanceof Set)return Array.from(e).map(o);if(e instanceof Map)return Object.fromEntries(Array.from(e,([e,n])=>[String(e),o(n)]));if(function(e){if(null===e||"object"!=typeof e)return!1;const n=Object.getPrototypeOf(e);return null===n||n===Object.prototype}(e)){const n={};for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&(n[t]=o(e[t]));return n}return null}function f(e){return null===e||"string"==typeof e||"number"==typeof e||"boolean"==typeof e}function u(e){return Array.isArray(e)}function d(e){return null!==e&&"object"==typeof e&&!Array.isArray(e)}function c(e){return 0===Object.keys(e).length}function s(e){return 0===e.length||e.every(e=>f(e))}function y(e){return 0===e.length||e.every(e=>d(e))}function a(e,t){return null===e?n:"boolean"==typeof e||"number"==typeof e?String(e):function(e,t=r){return function(e,t=r){return!(!e||e!==e.trim()||"true"===(i=e)||"false"===i||i===n||function(e){return/^-?\d+(?:\.\d+)?(?:e[+-]?\d+)?$/i.test(e)||/^0\d+$/.test(e)}(e)||e.includes(":")||e.includes('"')||e.includes("\\")||/[[\]{}]/.test(e)||/[\n\r\t]/.test(e)||e.includes(t)||e.startsWith("-"));var i}(e,t)?e:`${i}${l(e)}${i}`}(e,t)}function m(e){return function(e){return/^[A-Z_][\w.]*$/i.test(e)}(e)?e:`${i}${l(e)}${i}`}function $(e,n=r){return e.map(e=>a(e,n)).join(n)}function g(e,n){const t=n?.key,i=n?.fields,l=n?.delimiter??",";let o="";return t&&(o+=m(t)),o+=`[${e}${l!==r?l:""}]`,i&&(o+=`{${i.map(e=>m(e)).join(l)}}`),o+=":",o}function*p(e,n,t,i,r,l){const o=Object.keys(e);0!==n||i||(i=new Set(o.filter(e=>e.includes("."))));const f=l??t.flattenDepth;for(const[u,d]of Object.entries(e))yield*h(u,d,n,t,o,i,r,f)}function*h(n,t,i,r,l,o,s,y){const $=s?`${s}${e}${n}`:n,g=y??r.flattenDepth;if("safe"===r.keyFolding&&l){const y=function(n,t,i,r,l,o,f){if("safe"!==r.keyFolding)return;if(!d(t))return;const{segments:u,tail:s,leafValue:y}=function(e,n,t){const i=[e];let r=n;for(;i.length<t&&d(r);){const e=Object.keys(r);if(1!==e.length)break;const n=e[0],t=r[n];i.push(n),r=t}return!d(r)||c(r)?{segments:i,tail:void 0,leafValue:r}:{segments:i,tail:r,leafValue:r}}(n,t,f??r.flattenDepth);if(u.length<2)return;if(!u.every(e=>function(e){return/^[A-Z_]\w*$/i.test(e)}(e)))return;const a=function(n){return n.join(e)}(u),m=o?`${o}${e}${a}`:a;return i.includes(a)||l&&l.has(m)?void 0:{foldedKey:a,remainder:s,leafValue:y,segmentCount:u.length}}(n,t,l,r,o,s,g);if(y){const{foldedKey:n,remainder:t,leafValue:l,segmentCount:$}=y,h=m(n);if(void 0===t){if(f(l))return void(yield S(i,`${h}: ${a(l,r.delimiter)}`,r.indent));if(u(l))return void(yield*b(n,l,i,r));if(d(l)&&c(l))return void(yield S(i,`${h}:`,r.indent))}if(d(t)){yield S(i,`${h}:`,r.indent);const l=g-$,f=s?`${s}${e}${n}`:n;return void(yield*p(t,i+1,r,o,f,l))}}}const h=m(n);f(t)?yield S(i,`${h}: ${a(t,r.delimiter)}`,r.indent):u(t)?yield*b(n,t,i,r):d(t)&&(yield S(i,`${h}:`,r.indent),c(t)||(yield*p(t,i+1,r,o,$,g)))}function*b(e,n,t,i){if(0!==n.length)if(s(n))yield S(t,j(n,i.delimiter,e),i.indent);else if(function(e){return 0===e.length||e.every(e=>u(e))}(n)&&n.every(e=>s(e)))yield*function*(e,n,t,i){yield S(t,g(n.length,{key:e,delimiter:i.delimiter}),i.indent);for(const r of n)if(s(r)){const e=j(r,i.delimiter);yield I(t+1,e,i.indent)}}(e,n,t,i);else{if(y(n)){const r=v(n);return void(r?yield*function*(e,n,t,i,r){yield S(i,g(n.length,{key:e,fields:t,delimiter:r.delimiter}),r.indent),yield*k(n,t,i+1,r)}(e,n,r,t,i):yield*O(e,n,t,i))}yield*O(e,n,t,i)}else yield S(t,g(0,{key:e,delimiter:i.delimiter}),i.indent)}function j(e,n,t){const i=g(e.length,{key:t,delimiter:n}),r=$(e,n);return 0===e.length?i:`${i} ${r}`}function v(e){if(0===e.length)return;const n=Object.keys(e[0]);return 0!==n.length&&function(e,n){for(const t of e){if(Object.keys(t).length!==n.length)return!1;for(const e of n){if(!(e in t))return!1;if(!f(t[e]))return!1}}return!0}(e,n)?n:void 0}function*k(e,n,t,i){for(const r of e)yield S(t,$(n.map(e=>r[e]),i.delimiter),i.indent)}function*O(e,n,t,i){yield S(t,g(n.length,{key:e,delimiter:i.delimiter}),i.indent);for(const r of n)yield*N(r,t+1,i)}function*A(e,n,t){if(c(e))return void(yield S(n,"-",t.indent));const i=Object.entries(e),[r,l]=i[0],o=m(r);if(f(l))yield I(n,`${o}: ${a(l,t.delimiter)}`,t.indent);else if(u(l))if(s(l))yield I(n,j(l,t.delimiter,r),t.indent);else if(y(l)){const e=v(l);if(e)yield I(n,g(l.length,{key:r,fields:e,delimiter:t.delimiter}),t.indent),yield*k(l,e,n+1,t);else{yield I(n,`${o}[${l.length}]:`,t.indent);for(const e of l)yield*A(e,n+1,t)}}else{yield I(n,`${o}[${l.length}]:`,t.indent);for(const e of l)yield*N(e,n+1,t)}else d(l)&&(yield I(n,`${o}:`,t.indent),c(l)||(yield*p(l,n+2,t)));for(let f=1;f<i.length;f++){const[e,r]=i[f];yield*h(e,r,n+1,t)}}function*N(e,n,t){if(f(e))yield I(n,a(e,t.delimiter),t.indent);else if(u(e))if(s(e))yield I(n,j(e,t.delimiter),t.indent);else{yield I(n,g(e.length,{delimiter:t.delimiter}),t.indent);for(const i of e)yield*N(i,n+1,t)}else d(e)&&(yield*A(e,n,t))}function S(e,n,t){return" ".repeat(t*e)+n}function I(e,n,t){return S(e,"- "+n,t)}function E(e,n){return Array.from(function(e){return function*(e,n){if(f(e)){const t=a(e,n.delimiter);return void(""!==t&&(yield t))}u(e)?yield*b(void 0,e,0,n):d(e)&&(yield*p(e,0,n))}(o(e),{indent:2,delimiter:r,keyFolding:"off",flattenDepth:Number.POSITIVE_INFINITY})}(e)).join("\n")}export{E as e};