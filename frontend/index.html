<!DOCTYPE html>
<html lang="ru" color-mode="user" data-scheme="auto">
    <head>
        <meta charset="UTF-8"/>
        <meta name="viewport" content="width=device-width, viewport-fit=cover, initial-scale=1.0, interactive-widget=overlays-content, user-scalable=no, maximum-scale=1"/>

        <!---->
        <title>WebApp Runtime</title>

        <!---->
        <meta name="apple-mobile-web-app-capable" content="yes"/>
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/>
        <meta name="mobile-web-app-capable" content="yes"/>

        <!-- @vite-ignore -->
        <meta name="theme-color" content="transparent" data-theme-color/>
        <meta name="full-screen" content="yes"/>
        <meta name="application-name" content="WebApp"/>

        <!---->
        <meta property="og:locale" content="ru-RU"/>
        <meta http-equiv="content-language" content="ru-RU"/>

        <!---->
        <meta name="referrer" content="no-referrer">

        <!-- -->
        <meta name="robots" content="noindex, nofollow">

        <!-- -->
        <meta name="description" content="WebApp Runtime">

        <!-- -->
        <meta name="keywords" content="WebApp, Runtime, HTML, CSS, JavaScript">

        <!-- Prefetch wallpaper image -->
        <link fetchpriority="high" rel="prefetch" as="image" href="./assets/imgs/test.webp">
        <link fetchpriority="high" rel="prefetch" as="image" href="./assets/imgs/test.jpg">

        <!-- prefetch critical scripts -->
        <link fetchpriority="high" rel="prefetch" as="script" href="./apps/cw/index.js">
        <link fetchpriority="high" rel="prefetch" as="script" href="./load.mjs">
        <link fetchpriority="high" rel="prefetch" as="script" href="./vital.mjs">

        <!-- prefetch critical styles -->
        <link fetchpriority="high" rel="prefetch" as="style" href="./apps/cw/assets/style.css">
        <link fetchpriority="high" rel="prefetch" as="style" href="./apps/cw/assets/crossword.css">

        <!-- -->
        <base href="./" />

        <!-- -->
        <script>
            WeakMap.prototype.getOrInsert ??= function (key, defaultValue) {
                if (!this.has(key)) { this.set(key, defaultValue); }
                return this.get(key);
            };

            WeakMap.prototype.getOrInsertComputed ??= function (key, callbackFunction) {
                if (!this.has(key)) { this.set(key, callbackFunction(key)); }
                return this.get(key);
            };

            Map.prototype.getOrInsert ??= function (key, defaultValue) {
                if (!this.has(key)) { this.set(key, defaultValue); }
                return this.get(key);
            };

            Map.prototype.getOrInsertComputed ??= function (key, callbackFunction) {
                if (!this.has(key)) { this.set(key, callbackFunction(key)); }
                return this.get(key);
            };
        </script>

        <!-- critical styles -->
        <style data-owner="runtime" data-type="system">
        /* Hide undefined custom elements and problematic elements during load */
        :where(*):not(:defined) {
            opacity: 0 !important;
            visibility: collapse !important;
            pointer-events: none !important;
            display: none !important;
        }

        /* Hide script, link, style elements to prevent visual glitches */
        :where(link, script, style) {
            display: none !important;
            pointer-events: none !important;
            visibility: hidden !important;
        }

        @media screen {
            :where(*):not(:defined) { opacity: 0; visibility: collapse; pointer-events: none; display: none; background-color: transparent; color: transparent; };
            :where(link, head, script, style, meta) {
                display: none !important;
                pointer-events: none !important;
                interactivity: inert !important;
                user-select: none !important;
                touch-action: none !important;
            }

            /* */
            :where(*) {
                box-sizing: border-box;
            }

            /* */
            html {
                padding: 0px;
                margin: 0px;
                box-sizing: border-box;
                border: none 0px transparent;
                outline: none 0px transparent;

                /* */
                container-type: size;
                contain: strict;

                /* */
                inline-size: min(100cqi, 100dvi);
                block-size: min(100cqb, 100dvb);

                /* */
                max-inline-size: min(100cqi, 100dvi);
                max-block-size: min(100cqb, 100dvb);
            }

            /* */
            body {
                display: grid;
                grid-template-columns: minmax(0px, 1fr);
                grid-template-rows: minmax(0px, 1fr);
                overflow: hidden;
                flex-direction: column;
                pointer-events: none;
                padding: 0px;
                margin: 0px;
                place-content: center;
                place-items: center;
                align-content: start;
                align-items: start;
                position: relative;

                /* */
                border: none 0px transparent;
                outline: none 0px transparent;

                /* */
                container-type: size;
                contain: strict;

                /* */
                max-inline-size: max(100%, min(100cqi, 100dvi));
                max-block-size: max(100%, min(100cqb, 100dvb));

                /* */
                inline-size: stretch;
                block-size: stretch;

                /* */
                min-inline-size: stretch;
                min-block-size: max(100cqb, 100dvb);

                /* */
                pointer-events: auto; 
                overflow: hidden; 
                align-content: start; 
                align-items: start; 
                inset-block-end: auto; 
                inset-block-start: 0px; 
                border: none 0px transparent; 
                outline: none 0px transparent;

                /* */
                container-type: size;
                contain: strict;
            }

            /* */
            body > #app {
                max-inline-size: stretch;
                max-block-size: stretch;

                /* */
                inline-size: stretch;
                block-size: stretch;

                /* */
                min-inline-size: 0px;
                min-block-size: 0px;

                /* */
                grid-column: 1 / -1;
                grid-row: 1 / -1;

                /* */
                display: grid;
                grid-template-columns: minmax(0px, 1fr);
                grid-template-rows: minmax(0px, 1fr);

                /* */
                pointer-events: none;
                position: absolute;
                inset: 0px;

                /* */
                inset-inline-end: auto;
                inset-block-end: auto;
                overflow: hidden;

                /* */
                container-type: size;
                contain: strict;

                /* */
                margin: 0px; padding: 0px;
                border: none 0px transparent;
                outline: none 0px transparent;

                /* */
                pointer-events: auto; 
                background-color: --c2-surface(0.15, var(--current, currentColor)); 
                inline-size: stretch; 
                block-size: stretch; 
                max-block-size: stretch; 
                max-inline-size: stretch; 
                contain: strict; 
                border: none 0px transparent; outline: none 0px transparent;
            }

            /* fix virtual keyboard and overlays issues */
            #overlays {
                transition: block-size 100ms step-end;
                inline-size: 100dvi;
                block-size: min(100dvb, var(--view-height, 100dvb));
                position: fixed;
            }

            #filter {
                mix-blend-mode: multiply;
                inset: 0px;
                position: fixed;
                margin: 0px;
                padding: 0px;
                border: none 0px transparent;
                outline: none 0px transparent;
                min-inline-size: 0px;
                min-block-size: 0px;
                inline-size: stretch;
                block-size: stretch;
                max-inline-size: min(100%, min(100cqi, 100dvi));
                max-block-size: min(100%, min(100cqb, 100dvb));
                background-color: oklch(calc(var(--brightness, 1) * 0.4 + 0.6) calc(var(--night-mode, 0) * 0.05) 35);
                pointer-events: none;
                z-index: 9999999;
                content-visibility: visible;
                transform: translateZ(0px);
            }
        }

        @media print {
            :where(body, html) {
                place-content: start;
                place-items: start;
                text-align: start;
                padding: 0px;
                margin: 0px;
                border: none;
                outline: none;
                box-shadow: none;
                scrollbar-width: none;
                scrollbar-color: transparent transparent;
                -webkit-overflow-scrolling: touch;
                font-family: var(--print-font-family);
            }

            :where(body, html, :root)>*:not([hidden], [aria-hidden="true"], [data-hidden]):not(markdown-viewer, #markdown-body, .view-markdown),
            :where(body, html, :root) :where(#app, #raw-md),
            :where(body, html, :root) :where(div, span, button, input, header, main, footer):not([hidden], [aria-hidden="true"], [data-hidden]):not(markdown-viewer, #markdown-body, .view-markdown) {
                display: contents !important;
                page-break-after: avoid !important;
                page-break-before: avoid !important;
                break-after: avoid !important;
                break-before: avoid !important;
            }

            .view-viewer,
            .view-viewer__content,
            [data-viewer-content] {
                display: contents !important;
                page-break-after: avoid !important;
                page-break-before: avoid !important;
                break-after: avoid !important;
                break-before: avoid !important;
            }

            body,
            html,
            :root {
                background-color: initial;
                color: initial;
                padding: 0px !important;
                margin: 0px !important;
                overflow-x: hidden !important;
                overflow-y: auto !important;
                container-type: inline-size !important;
                border: 0px none transparent !important;
                outline: 0px none transparent !important;
            }

            :where(*) {
                scrollbar-width: none;
                -ms-overflow-style: none;

                &::-webkit-scrollbar {
                    display: none;
                }
            }

            .loading-spinner, .loading-message,
            [data-hidden], [hidden], [aria-hidden="true"],
            .view-viewer__toolbar, [data-viewer-toolbar],
            button, nav, .app-shell__loading,
            head, [hidden], [aria-hidden="true"], [data-hidden], .app-loading, .view-viewer__toolbar, .app-shell__status, #raw-md, .markdown-viewer-raw {
                &, & * {
                    display: none !important;
                    position: absolute !important;
                    inset: 0 !important;
                    z-index: -1 !important;
                    opacity: 0 !important;
                    inline-size: 0 !important;
                    block-size: 0 !important;
                    border: none !important;
                    outline: none !important;
                    box-shadow: none !important;
                    scrollbar-width: none !important;
                    scrollbar-color: transparent transparent !important;
                    overflow: hidden !important;
                    -webkit-overflow-scrolling: touch !important;
                    padding: 0 !important;
                    margin: 0 !important;
                    font: initial !important;
                    font-size: initial !important;
                    font-weight: initial !important;
                    font-family: initial !important;
                    font-style: initial !important;
                    font-variant: initial !important;
                    line-height: 0 !important;
                    color: transparent !important;
                    background: transparent !important;
                    pointer-events: none !important;
                    user-select: none !important;
                    touch-action: none !important;
                    cursor: none !important;
                    opacity: 0 !important;
                    visibility: collapse !important;
                    pointer-events: none !important;
                    interactivity: inert !important;
                    break-after: avoid !important;
                    break-before: avoid !important;
                    font-size: 0 !important;
                    line-height: 0 !important;
                    overflow: hidden !important;
                    contain: strict !important;
                    page-break-after: avoid !important;
                    page-break-before: avoid !important;
                    break-after: avoid !important;
                    break-before: avoid !important;
                }
            }

            #app, .app-shell, .view-viewer, .view-viewer__content, .markdown-body, .markdown-viewer-content, .result-content {
                display: contents !important;
                margin: 0 !important;
                padding: 0 !important;
                border: none !important;
                outline: none !important;
                box-shadow: none !important;
                overflow: visible !important;
                scrollbar-width: none !important;
                scrollbar-color: transparent transparent !important;
                -webkit-overflow-scrolling: touch !important;
                page-break-after: avoid !important;
                page-break-before: avoid !important;
                break-after: avoid !important;
                break-before: avoid !important;
            }
        }
        </style>

        <!-- Critical resource hints -->
        <link rel="modulepreload" href="./apps/cw/index.js" fetchpriority="high">
        <link rel="modulepreload" href="./load.mjs">
        <link rel="modulepreload" href="./vital.mjs">

        <!-- webpackIgnore: true-->
        <link rel="manifest" href="./apps/cw/pwa/manifest.json">
        <link rel="apple-touch-icon" href="./favicon.png">
        <link rel="icon" type="image/png" href="./favicon.png">
        <link rel="icon" type="image/svg+xml" href="./favicon.svg">

        <!-- Init script - deferred to not block parsing -->
        <script src="./init.mjs" defer></script>
    </head>
    <body>
        <div id="app" class="c2-surface"></div>
        <script src="./load.mjs" type="module" async defer></script>
    </body>
</html>
